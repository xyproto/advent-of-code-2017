Solution found by writing a prototype in Python:

1144
